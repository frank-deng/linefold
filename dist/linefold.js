!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.linefold=t():e.linefold=t()}(self,(function(){return(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{default:()=>u});const n={"!":!0,")":!0,",":!0,".":!0,":":!0,";":!0,"?":!0,"]":!0,"}":!0,"¨":!0,"·":!0,ˇ:!0,ˉ:!0,"―":!0,"‖":!0,"’":!0,"”":!0,"…":!0,"∶":!0,"、":!0,"。":!0,"〃":!0,々:!0,"〉":!0,"》":!0,"」":!0,"』":!0,"】":!0,"〕":!0,"〗":!0,"！":!0,"＂":!0,"＇":!0,"）":!0,"，":!0,"．":!0,"：":!0,"；":!0,"？":!0,"］":!0,"｀":!0,"｜":!0,"｝":!0,"～":!0,"￠":!0},r={"(":!0,"[":!0,"{":!0,"·":!0,"‘":!0,"“":!0,"〈":!0,"《":!0,"「":!0,"『":!0,"【":!0,"〔":!0,"〖":!0,"（":!0,"．":!0,"［":!0,"｛":!0,"￡":!0,"￥":!0};let l=null;try{const e=document.createElement("canvas");e.width=e.height=16,l=e.getContext("2d")}catch(e){console.info("HTML5 canvas not available, default canvas-based string length measuring will not work")}function o(e,t=[]){if(!t.length)return null;for(let n of t)try{let t=n.exec(e);if(t&&0==t.index)return t[0]}catch(e){console.error(e)}return e[0]}function f(e,t,n){let r=[],l=0,o=1,f=e.length;for(;l<f&&o<=f;){let f=e.slice(l,o);n(f)<=t?o++:f.length<=1?(r.push(f[0]),l++,o++):(r.push(e.slice(l,o-1)),l=o-1)}return l<f&&r.push(e.slice(l,f)),r.length?r:[e]}function u(e,t,u,c=[]){let s=function(e){return l.measureText(e).width};if(l&&"string"==typeof u)l.font=u;else{if("function"!=typeof u)throw new TypeError("Second parameter must be a function for measuring string length");s=u}let i=function(e,t=[]){let l=[],f=e.slice(),u=null;for(;f.length;){let e=o(f,[...t,/^[^\S\r\n]+/,/^[A-Za-z0-9\u0430-\u04ff]+[^\S\r\n]*/i]);f=f.slice(e.length),"\n"!=e&&l.length&&(r[u]||n[e]||/^[^\S\r\n]+$/.test(e))?l[l.length-1]+=e:l.push(e),u=e}return l}(e,c);for(let e=i.length-1;e>=0;e--){let n=i[e];s(n)<=t||i.splice(e,1,...f(n,t,s))}let a=[],p="";for(let e of i)"\n"!=e?s(p+e.replace(/\s+$/g,""))<=t?p+=e:(a.push(p.replace(/\s+$/g,"")),p=e):(a.push(p.replace(/\s+$/g,"")),p="");return p.length&&a.push(p.replace(/\s+$/g,"")),a}return t.default})()}));