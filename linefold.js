!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.linefold=t():e.linefold=t()}(self,(function(){return(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{group:()=>u,split:()=>i,default:()=>f});const n={"!":!0,")":!0,",":!0,".":!0,":":!0,";":!0,"?":!0,"]":!0,"}":!0,"¨":!0,"·":!0,ˇ:!0,ˉ:!0,"―":!0,"‖":!0,"’":!0,"”":!0,"…":!0,"∶":!0,"、":!0,"。":!0,"〃":!0,々:!0,"〉":!0,"》":!0,"」":!0,"』":!0,"】":!0,"〕":!0,"〗":!0,"！":!0,"＂":!0,"＇":!0,"）":!0,"，":!0,"．":!0,"：":!0,"；":!0,"？":!0,"］":!0,"｀":!0,"｜":!0,"｝":!0,"～":!0,"￠":!0},r={"(":!0,"[":!0,"{":!0,"·":!0,"‘":!0,"“":!0,"〈":!0,"《":!0,"「":!0,"『":!0,"【":!0,"〔":!0,"〖":!0,"（":!0,"．":!0,"［":!0,"｛":!0,"￡":!0,"￥":!0};let o=null;try{const e=document.createElement("canvas");e.width=e.height=16,o=e.getContext("2d")}catch(e){console.info("HTML5 canvas not available, default canvas-based string length measuring will not work")}function l(e,t=[]){if(!t.length)return null;for(let n of t)try{let t=n.exec(e);if(t&&0==t.index)return t[0]}catch(e){console.error(e)}return e[0]}function u(e,t=[]){let o=[],u=e.slice(),i=null;for(;u.length;){let e=l(u,[...t,/^[^\S\r\n]+/,/^[A-Za-z0-9\u0430-\u04ff]+[^\S\r\n]*/i]);u=u.slice(e.length),"\n"!=e&&o.length&&(r[i]||n[e]||/^[^\S\r\n]+$/.test(i)||/^[^\S\r\n]+$/.test(e))?o[o.length-1]+=e:o.push(e),i=e}return o}function i(e,t,n){let r=[],o=0,l=1,u=e.length;for(;o<u&&l<=u;){let u=e.slice(o,l);n(u)<=t?l++:u.length<=1?(r.push(u[0]),o++,l++):(r.push(e.slice(o,l-1)),o=l-1)}return o<u&&r.push(e.slice(o,u)),r.length?r:[e]}function f(e,t,n,r=[]){let l=function(e){return o.measureText(e).width};if(o&&"string"==typeof n)o.font=n;else{if("function"!=typeof n)throw new TypeError("Second parameter must be a function for measuring string length");l=n}let f=u(e,r);for(let e=f.length-1;e>=0;e--){let n=f[e];l(n)<=t||f.splice(e,1,...i(n,t,l))}let s=[],c="";for(let e of f)"\n"!=e?l(c+e.replace(/\s+$/g,""))<=t?c+=e:(s.push(c.replace(/\s+$/g,"")),c=e):(s.push(c.replace(/\s+$/g,"")),c="");return c.length&&s.push(c.replace(/\s+$/g,"")),s}return t})()}));